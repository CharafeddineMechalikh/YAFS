<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basic Concepts &mdash; YAFS 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="YAFS 0.1 documentation" href="../contents.html" />
    <link rel="up" title="YAFS in 5 Minutes" href="index.html" />
    <link rel="next" title="Architecture" href="../architecture/index.html" />
    <link rel="prev" title="Glossary of terms" href="glossary.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="basic-concepts">
<h1>Basic Concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this headline">¶</a></h1>
<p>In order to run a YAFS simulation you should define the following elements:</p>
<div class="section" id="network-topology">
<h2>Network Topology<a class="headerlink" href="#network-topology" title="Permalink to this headline">¶</a></h2>
<p>A topology consists of a set of nodes and links. The nodes are elements of the network that serve as a link between other elements and have the ability to execute or host the application.</p>
<p>That is, a node has associated computing characteristics:</p>
<ul class="simple">
<li><strong>IPT</strong> Instructions per simulation time. It is equivalent to IPS but it is the user how fix the unit time (i.e. seconds, milliseconds, etc.). Time simulation units is set by the user.</li>
<li><strong>RAM</strong> Memory available</li>
<li><strong>COST</strong> Cost per unit time</li>
</ul>
<p>A link has associated these performance characteristics:</p>
<ul class="simple">
<li><strong>BW</strong> Channel Bandwidth: in Bytes</li>
<li><strong>PR</strong> Channel Propagation speed</li>
<li><strong>Latency</strong> is dynamically computed using: Message.size.bits / BW + PR</li>
</ul>
<p>A network can be created using a json file or through more complex algorithms (see <a class="reference internal" href="../architecture/index.html#architecture"><span>architecture details</span></a>).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sim.topology</span> <span class="kn">import</span> <span class="n">Topology</span>
<span class="kn">from</span> <span class="nn">sim.topology</span> <span class="kn">import</span> <span class="n">Entity</span>

<span class="n">topology_json</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;entity&quot;</span><span class="p">:[</span>
        <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="n">Entity</span><span class="o">.</span><span class="n">ENTITY_FOG</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;F_0&quot;</span><span class="p">,</span> <span class="s2">&quot;IPT&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;RAM&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;COST&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="n">Entity</span><span class="o">.</span><span class="n">ENTITY_FOG</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;F_1&quot;</span><span class="p">,</span> <span class="s2">&quot;IPT&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;RAM&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;COST&quot;</span><span class="p">:</span><span class="mi">15</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="n">Entity</span><span class="o">.</span><span class="n">ENTITY_FOG</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;F_0&quot;</span><span class="p">,</span> <span class="s2">&quot;IPT&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;RAM&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;COST&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="n">Entity</span><span class="o">.</span><span class="n">ENTITY_FOG</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;F_0&quot;</span><span class="p">,</span> <span class="s2">&quot;IPT&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;RAM&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;COST&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="n">Entity</span><span class="o">.</span><span class="n">ENTITY_CLUSTER</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;C_1&quot;</span><span class="p">,</span> <span class="s2">&quot;IPT&quot;</span><span class="p">:</span><span class="mi">100000</span><span class="p">,</span> <span class="s2">&quot;RAM&quot;</span><span class="p">:</span><span class="mi">4000</span><span class="p">,</span> <span class="s2">&quot;COST&quot;</span><span class="p">:</span><span class="mi">15</span><span class="p">}</span>
        <span class="p">],</span>
    <span class="s2">&quot;link&quot;</span><span class="p">:[</span>
        <span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;BW&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;PR&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;BW&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;PR&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;BW&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;PR&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;BW&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;PR&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;BW&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;PR&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
    <span class="p">]}</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Topology</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">topology_json</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="application">
<h2>Application<a class="headerlink" href="#application" title="Permalink to this headline">¶</a></h2>
<p>The applicaiton follows the DDF model, in which an application is modeled as directed graph, the vertices of the directed acyclic graph (DAG) representing modules that perform processing on incoming data and edge denoting data dependencies among modules.</p>
<p>An application is set by a group of modules. A module can create messages (a pure source / sensor), a modul can consume messages (a pure sink  / actuator ) and other modules can do both tasks.</p>
<p>The dependencies among modules are defined through messages.</p>
<p>A <strong>message</strong> is the representation of a request between two modules. A message is set by an unique ID in the same application. It has a source and destiny module, a length of instructions, and a number of bytes. If the message arrive a pure sink this message does not require the last two attributes. In YAFS, it is possible to define <em>broadcast messages</em>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">m_global_game_state</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Global_Game_State&quot;</span><span class="p">,</span> <span class="s2">&quot;Coordinator&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">280</span><span class="p">)</span>
<span class="n">m_self_state_update</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Self_State_Update&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="s2">&quot;Display&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We illustrate this example using <em>EEG_GAME application</em> <a class="footnote-reference" href="#f1" id="id1">[1]</a> following the idea used in CloudSim <a class="footnote-reference" href="#f2" id="id2">[2]</a> and other similar cloud simulators.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User defines the distribution functions that modules use to create and send the different messages. In this example, the user defines: <em>fractional_selectivity</em> and <em>next_time_periodic</em>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In <em>sim.utils</em> package there are defined several distributions</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">sim.application</span> <span class="kn">import</span> <span class="n">Application</span>
<span class="kn">from</span> <span class="nn">sim.application</span> <span class="kn">import</span> <span class="n">Message</span>

<span class="c1">#A periodic function</span>
<span class="k">def</span> <span class="nf">next_time_periodic</span><span class="p">(</span><span class="n">time_shift</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">time_shift</span>

<span class="c1">#A threshold function</span>
<span class="k">def</span> <span class="nf">fractional_selectivity</span><span class="p">(</span><span class="n">threshold</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">threshold</span>

<span class="k">def</span> <span class="nf">create_aplication</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="c1"># APPLICATION</span>
    <span class="c1"># App.name is unique</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Application</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Modules/Services of the application</span>
    <span class="n">a</span><span class="o">.</span><span class="n">modules</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;EGG&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="s2">&quot;Calculator&quot;</span><span class="p">,</span> <span class="s2">&quot;Coordinator&quot;</span><span class="p">,</span> <span class="s2">&quot;Display&quot;</span><span class="p">]</span>

    <span class="c1">#Setting pure source modules or Sensors</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_module</span><span class="p">([</span><span class="s2">&quot;EGG&quot;</span><span class="p">],</span> <span class="n">Application</span><span class="o">.</span><span class="n">TYPE_SOURCE</span><span class="p">)</span>
    <span class="c1">#Setting pure sink modules or Actuators</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_module</span><span class="p">([</span><span class="s2">&quot;Display&quot;</span><span class="p">],</span> <span class="n">Application</span><span class="o">.</span><span class="n">TYPE_SINK</span><span class="p">)</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Messages among MODULES</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m_egg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.EGG&quot;</span><span class="p">,</span> <span class="s2">&quot;EGG&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="mi">2000000000</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span> <span class="c1">#Instrucctrions, Bytes</span>
    <span class="n">m_sensor</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Sensor&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="s2">&quot;Calculator&quot;</span><span class="p">,</span> <span class="mi">3500</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
    <span class="n">m_concentration</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Concentration&quot;</span><span class="p">,</span> <span class="s2">&quot;Calculator&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">m_player_game_state</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Player_Game_State&quot;</span><span class="p">,</span> <span class="s2">&quot;Calculator&quot;</span><span class="p">,</span> <span class="s2">&quot;Coordinator&quot;</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">m_global_game_state</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Global_Game_State&quot;</span><span class="p">,</span> <span class="s2">&quot;Coordinator&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">280</span><span class="p">)</span>
    <span class="n">m_self_state_update</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Self_State_Update&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="s2">&quot;Display&quot;</span><span class="p">)</span>
    <span class="n">m_global_state_update</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;M.Global_State_Update&quot;</span><span class="p">,</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="s2">&quot;Display&quot;</span><span class="p">)</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defining which messages will be dynamically generated</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_source_messages</span><span class="p">(</span><span class="n">m_egg</span><span class="p">)</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    MODULES/SERVICES: Definition of Generators and Consumers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># MODULE SOURCES: only messages generated by non-pure sources</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_source</span><span class="p">(</span><span class="s2">&quot;Calculator&quot;</span><span class="p">,</span> <span class="n">next_time_periodic</span><span class="p">,</span> <span class="n">m_player_game_state</span><span class="p">,</span> <span class="n">time_shift</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_source</span><span class="p">(</span><span class="s2">&quot;Coordinator&quot;</span><span class="p">,</span> <span class="n">next_time_periodic</span><span class="p">,</span> <span class="n">m_global_game_state</span><span class="p">,</span> <span class="n">time_shift</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">)</span>
    <span class="c1"># MODULE SERVICES</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="n">m_egg</span><span class="p">,</span> <span class="n">m_sensor</span><span class="p">,</span> <span class="n">fractional_selectivity</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="n">m_concentration</span><span class="p">,</span> <span class="n">m_self_state_update</span><span class="p">,</span> <span class="n">fractional_selectivity</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Client&quot;</span><span class="p">,</span> <span class="n">m_global_game_state</span><span class="p">,</span> <span class="n">m_global_state_update</span><span class="p">,</span> <span class="n">fractional_selectivity</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Calculator&quot;</span><span class="p">,</span> <span class="n">m_sensor</span><span class="p">,</span> <span class="n">m_concentration</span><span class="p">,</span> <span class="n">fractional_selectivity</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Coordinator&quot;</span><span class="p">,</span> <span class="n">m_player_game_state</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Display&quot;</span><span class="p">,</span> <span class="n">m_self_state_update</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_service_module</span><span class="p">(</span><span class="s2">&quot;Display&quot;</span><span class="p">,</span> <span class="n">m_global_state_update</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span>

<span class="n">app1</span> <span class="o">=</span> <span class="n">create_aplication</span><span class="p">(</span><span class="s2">&quot;EGG_GAME&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="population-model">
<h2>Population model<a class="headerlink" href="#population-model" title="Permalink to this headline">¶</a></h2>
<p>In real scenarios, sensors can move in the IoT ecosystem which it means, they can invoke services for several access points.
For that reason, each population model is associated to one application and it runs according to a set of events or time distribution.</p>
<p>The association of controls to a node can be dynamic and this process is executed every certain time to change the creation policies associated with the nodes. The population model can be so complex as you wish. More advanced details in <a class="reference internal" href="../architecture/index.html#architecture"><span>architecture details</span></a>.</p>
<p>The most simple case, it is a statical creation of requests. For each message of a pure service source (or sensor), it will have a generation control associated to it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sim.population</span> <span class="kn">import</span> <span class="n">Statical</span>

<span class="k">def</span> <span class="nf">next_time_exponential_dist</span><span class="p">(</span><span class="n">lambd</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">lambd</span><span class="p">)</span>

<span class="n">pop</span> <span class="o">=</span> <span class="n">Statical</span><span class="p">(</span><span class="s2">&quot;Statical&quot;</span><span class="p">)</span>
<span class="n">ctrl_generator</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span><span class="n">app1</span><span class="o">.</span><span class="n">get_source_message</span><span class="p">(</span><span class="s2">&quot;M.EGG&quot;</span><span class="p">),</span><span class="s2">&quot;dist&quot;</span><span class="p">:</span><span class="n">next_time_exponential_dist</span><span class="p">,</span><span class="s2">&quot;param&quot;</span><span class="p">:{</span><span class="s2">&quot;lambd&quot;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">}}</span>
<span class="n">pop</span><span class="o">.</span><span class="n">set_generator_control</span><span class="p">({</span><span class="s2">&quot;node&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">:</span><span class="n">ctrl_generator</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="selector-model">
<h2>Selector model<a class="headerlink" href="#selector-model" title="Permalink to this headline">¶</a></h2>
<p>This module is the &#8220;service orchestration&#8221;. It is the coordination and arrangement of multiple services exposed as a single aggregate service.</p>
<p>The most simple case is one to one module using the shortest path between both modules.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sim.selection</span> <span class="kn">import</span> <span class="n">First_ShortestPath</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">First_ShortestPath</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="placement-algorithm">
<h2>Placement algorithm<a class="headerlink" href="#placement-algorithm" title="Permalink to this headline">¶</a></h2>
<p>In this module is implemented the algorithm to allocation resources.
Placement module has two public methods: <em>initial_allocation</em> and <em>run</em>. The first is used in the first deployment of the application, the second one is used to move this modules in the topological entities according with some multi-objetive allocation algorithm or whatever idea.</p>
<p>The most usual case is a deployment in the cluster. In this case, sink nodes (actuators) are fixed in the topology.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ClusterPlacement</span><span class="p">(</span><span class="n">Placement</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initial_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sim</span><span class="p">):</span>
        <span class="c1">#We loook for the most cheaper cluster</span>
        <span class="c1">#We guess that the cluster has the computational resources to serve the whole apps</span>
        <span class="n">cheapest_cost</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
        <span class="n">id_cheapest</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">clusterNodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cheapest_cost</span> <span class="o">&gt;=</span> <span class="n">sim</span><span class="o">.</span><span class="n">entity_metrics</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;COST&quot;</span><span class="p">]:</span>
                <span class="n">cheapest_cost</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">entity_metrics</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;COST&quot;</span><span class="p">]</span>
                <span class="n">id_cheapest</span> <span class="o">=</span> <span class="nb">id</span>

        <span class="c1">#Assignment of SERVICES in topology nodes</span>
        <span class="k">for</span> <span class="n">app_name</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">placement_policy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;apps&quot;</span><span class="p">]:</span>
            <span class="n">app</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">apps</span><span class="p">[</span><span class="n">app_name</span><span class="p">]</span>
            <span class="c1">#Double control</span>
            <span class="c1">#module --&gt; app.node_entity</span>
            <span class="n">sim</span><span class="o">.</span><span class="n">assignaments_app_module</span><span class="p">[</span><span class="n">app_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">get_pure_modules</span><span class="p">(),</span><span class="n">id_cheapest</span><span class="p">)</span>
            <span class="c1">#entity --&gt; modules.app</span>
            <span class="n">sim</span><span class="o">.</span><span class="n">assignaments_entity_module</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id_cheapest</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="n">app_name</span><span class="p">:</span><span class="n">app</span><span class="o">.</span><span class="n">get_pure_modules</span><span class="p">()})</span>

        <span class="c1">#Assignment of SINK pure modules</span>
        <span class="k">for</span> <span class="n">sink_module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sink_control</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">sink_module</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">]</span>
            <span class="n">module</span> <span class="o">=</span> <span class="n">sink_module</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]</span>
            <span class="n">sim</span><span class="o">.</span><span class="n">deploy_sink</span><span class="p">(</span><span class="n">app_name</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sim</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Activiting - Placement on CLUSTER&quot;</span><span class="p">)</span>
        <span class="bp">None</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">ClusterPlacement</span><span class="p">(</span><span class="s2">&quot;onCluster&quot;</span><span class="p">,</span> <span class="n">activation_dist</span><span class="o">=</span><span class="n">next_time_periodic</span><span class="p">,</span> <span class="n">time_shift</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_sink_control</span><span class="p">({</span><span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">app1</span><span class="o">.</span><span class="n">get_sink_modules</span><span class="p">()[</span><span class="mi">0</span><span class="p">]})</span>  <span class="c1"># Asigna &quot;Display&quot; -solo hay uno- en un unico node</span>
</pre></div>
</div>
</div>
<div class="section" id="running-the-simulator">
<h2>Running the simulator<a class="headerlink" href="#running-the-simulator" title="Permalink to this headline">¶</a></h2>
<p>Once defined the previous elements, we can associate them to the simulator. To do this, you have to <em>deploy</em> the application with its respective topology policies. Once this is done, we can launch the simulation.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="c1"># t is the topology</span>
<span class="n">simulation_time</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">s</span><span class="o">.</span><span class="n">deploy_app</span><span class="p">(</span><span class="n">application</span><span class="p">,</span><span class="n">placement</span><span class="p">,</span><span class="n">population</span><span class="p">,</span><span class="n">selector</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>The results are stored in a nosql database in a json format. One of the main events is the registration of each message in each entity of the topology that manages it.
In these types of events, the following attributes are recorded:</p>
<ul class="simple">
<li><strong>msg_name</strong> message name</li>
<li><strong>app</strong>  application name</li>
<li><strong>service</strong>  service time</li>
<li><strong>module</strong> Module or service who manages it</li>
<li><strong>id_node</strong> identifier of the entity of the topology where is deployed the <em>module</em></li>
<li><strong>from_module</strong> Module or service who send this message</li>
<li><strong>from_node</strong> identifier of the entity of the topology where is deployed the <em>from_module</em></li>
<li><strong>time_emit</strong> time when the message was sent</li>
<li><strong>time_int</strong> time when the <em>module</em> accepts it</li>
<li><strong>time_service</strong> service time</li>
<li><strong>time_out</strong> time when the <em>module</em> finishes its process</li>
<li><strong>type</strong> is an identifier of the record type</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>units of time</strong> have the scale defined by the user in the respective distribution units. It means, the results of time are the times of the simulator.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;id_node&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;EGG_GAME&quot;</span><span class="p">,</span>
   <span class="s2">&quot;from_module&quot;</span><span class="p">:</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
   <span class="s2">&quot;module&quot;</span><span class="p">:</span> <span class="s2">&quot;Display&quot;</span><span class="p">,</span>
   <span class="s2">&quot;time_reception&quot;</span><span class="p">:</span> <span class="mf">41.43794155095091</span><span class="p">,</span>
   <span class="s2">&quot;msg_name&quot;</span><span class="p">:</span> <span class="s2">&quot;M.Self_State_Update&quot;</span><span class="p">,</span>
   <span class="s2">&quot;time_emit&quot;</span><span class="p">:</span> <span class="mf">38.43794155095091</span><span class="p">,</span>
   <span class="s2">&quot;time_in&quot;</span><span class="p">:</span> <span class="mf">41.43794155095091</span><span class="p">,</span>
   <span class="s2">&quot;time_out&quot;</span><span class="p">:</span> <span class="mf">41.43794155095091</span><span class="p">,</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;SINK_M&quot;</span><span class="p">,</span>
   <span class="s2">&quot;from_node&quot;</span><span class="p">:</span> <span class="mi">4</span>
 <span class="p">},</span>
 <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;id_node&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
   <span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;EGG_GAME&quot;</span><span class="p">,</span>
   <span class="s2">&quot;from_module&quot;</span><span class="p">:</span> <span class="s2">&quot;EGG&quot;</span><span class="p">,</span>
   <span class="s2">&quot;module&quot;</span><span class="p">:</span> <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
   <span class="s2">&quot;time_reception&quot;</span><span class="p">:</span> <span class="mf">202.44473295301344</span><span class="p">,</span>
   <span class="s2">&quot;msg_name&quot;</span><span class="p">:</span> <span class="s2">&quot;M.EGG&quot;</span><span class="p">,</span>
   <span class="s2">&quot;time_emit&quot;</span><span class="p">:</span> <span class="mf">202.44473295301344</span><span class="p">,</span>
   <span class="s2">&quot;time_in&quot;</span><span class="p">:</span> <span class="mf">202.44473295301344</span><span class="p">,</span>
   <span class="s2">&quot;time_out&quot;</span><span class="p">:</span> <span class="mf">222.44473295301344</span><span class="p">,</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;COMP_M&quot;</span><span class="p">,</span>
   <span class="s2">&quot;from_node&quot;</span><span class="p">:</span> <span class="mi">0</span>
 <span class="p">},</span>
</pre></div>
</div>
<p>How to obtain statistics of these results depends on the user, although there are a good number of processes implemented to obtain the main stats such as: average response time, average service time, average wait time, node utilization, average link latency, costs, and so on.</p>
<p>You can find this example in the following subsection: <a class="reference internal" href="../examples/tutorial_example.html#tutorial-example"><span>basic example</span></a>.</p>
<p>So far, we have explained the main parts of the simulator. Maybe it takes more than 5 minutes to understand this modelling, but the title of the section was attractive with that number. If you want to go deeper, you have to look at the rest of the sections: <a class="reference internal" href="../architecture/index.html#architecture"><span>architecture details</span></a> explaining key concepts, a number of <a class="reference internal" href="../examples/index.html#examples"><span>examples</span></a> and the <a class="reference internal" href="../api_reference/index.html#api-reference"><span>API reference</span></a>.</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Gupta, H., Vahid Dastjerdi, A., Ghosh, S. K., &amp; Buyya, R. (2017). iFogSim: A toolkit for modeling and simulation of resource management techniques in the Internet of Things, Edge and Fog computing environments. Software: Practice and Experience, 47(9), 1275-1296.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="f2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Calheiros, R. N., Ranjan, R., Beloglazov, A., De Rose, C. A., &amp; Buyya, R. (2011). CloudSim: a toolkit for modeling and simulation of cloud computing environments and evaluation of resource provisioning algorithms. Software: Practice and experience, 41(1), 23-50.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../contents.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">OVERVIEW</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">YAFS in 5 Minutes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary of terms</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Basic Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#network-topology">Network Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application">Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#population-model">Population model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selector-model">Selector model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#placement-algorithm">Placement algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-simulator">Running the simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API REFERENCE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">ABOUT</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  <li><a href="index.html">YAFS in 5 Minutes</a><ul>
      <li>Previous: <a href="glossary.html" title="previous chapter">Glossary of terms</a></li>
      <li>Next: <a href="../architecture/index.html" title="next chapter">Architecture</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Isaac Lera, Carlos Guerrero.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/introduction/basic.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>